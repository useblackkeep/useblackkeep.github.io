<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.gstatic.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://*.firebaseio.com https://*.googleapis.com wss://*.firebaseio.com; img-src 'self' data: https: blob:; media-src blob:;">
    <title>BlackKeep â€” Messenger</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #08080d; --bg-elevated: #0e0e16; --bg-surface: #14141e;
            --fg: #e2e2f0; --fg-muted: #5a5a72; --fg-dim: #8a8aa8;
            --accent: #00d4ff; --accent-dim: rgba(0,212,255,0.12); --accent-glow: rgba(0,212,255,0.35);
            --success: #00ff88; --error: #ff3b5c; --warning: #ffb800;
            --border: #1e1e2e; --border-bright: #2e2e44;
            --sidebar-w: 260px; --chat-header-h: 56px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; }
        body { font-family: 'JetBrains Mono', monospace; background: var(--bg); color: var(--fg); font-size: 13px; line-height: 1.6; }
        body::before { content: ''; position: fixed; inset: 0; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E"); pointer-events: none; z-index: 9999; opacity: 0.4; }

        /* LOADING */
        #loadingScreen { position: fixed; inset: 0; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; transition: opacity 0.5s ease; }
        #loadingScreen.fade-out { opacity: 0; pointer-events: none; }
        #loadingScreen.hidden { display: none; }
        .loading-logo { font-size: 28px; font-weight: 700; letter-spacing: 0.2em; margin-bottom: 40px; }
        .loading-logo .accent { color: var(--accent); }
        .loading-bars { display: flex; gap: 4px; margin-bottom: 24px; }
        .loading-bar { width: 3px; background: var(--accent); border-radius: 2px; animation: barPulse 1.2s ease infinite; }
        .loading-bar:nth-child(1){height:16px;animation-delay:0s} .loading-bar:nth-child(2){height:28px;animation-delay:.15s} .loading-bar:nth-child(3){height:40px;animation-delay:.3s} .loading-bar:nth-child(4){height:28px;animation-delay:.45s} .loading-bar:nth-child(5){height:16px;animation-delay:.6s}
        @keyframes barPulse { 0%,100%{opacity:.2;transform:scaleY(.6)} 50%{opacity:1;transform:scaleY(1)} }
        .loading-text { font-size: 11px; color: var(--fg-muted); letter-spacing: 0.15em; text-transform: uppercase; }

        /* LAYOUT */
        .app { display: flex; height: 100vh; }

        /* LEFT SIDEBAR */
        .sidebar { width: var(--sidebar-w); background: var(--bg-elevated); border-right: 1px solid var(--border); display: flex; flex-direction: column; flex-shrink: 0; }

        .sidebar-header { padding: 14px 16px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 15px; font-weight: 700; letter-spacing: 0.15em; }
        .logo .accent { color: var(--accent); }
        .sidebar-actions { display: flex; gap: 4px; }
        .icon-btn { width: 32px; height: 32px; border-radius: 6px; background: none; border: 1px solid transparent; color: var(--fg-muted); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; position: relative; }
        .icon-btn:hover { border-color: var(--border-bright); color: var(--fg); background: var(--bg-surface); }
        .icon-btn.active { border-color: var(--accent); color: var(--accent); background: var(--accent-dim); }

        /* TAB NAV */
        .sidebar-tabs { display: flex; padding: 8px 10px; gap: 4px; border-bottom: 1px solid var(--border); flex-shrink: 0; }
        .tab-btn { flex: 1; padding: 7px 4px; border: 1px solid transparent; border-radius: 6px; background: none; color: var(--fg-muted); font-family: 'JetBrains Mono', monospace; font-size: 10px; cursor: pointer; transition: all 0.2s; letter-spacing: 0.05em; text-align: center; position: relative; }
        .tab-btn:hover { color: var(--fg); background: var(--bg-surface); }
        .tab-btn.active { color: var(--accent); border-color: rgba(0,212,255,0.2); background: var(--accent-dim); }
        .tab-badge { position: absolute; top: 2px; right: 2px; width: 7px; height: 7px; border-radius: 50%; background: var(--error); display: none; }
        .tab-badge.visible { display: block; }

        /* SEARCH */
        .sidebar-search { padding: 8px 10px; border-bottom: 1px solid var(--border); }
        .search-input { width: 100%; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 6px; padding: 8px 12px; color: var(--fg); font-family: 'JetBrains Mono', monospace; font-size: 12px; outline: none; }
        .search-input:focus { border-color: var(--accent); }
        .search-input::placeholder { color: var(--fg-muted); }

        /* CHAT LIST */
        .chat-list { flex: 1; overflow-y: auto; }
        .chat-list-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; cursor: pointer; border-bottom: 1px solid transparent; transition: all 0.15s; position: relative; }
        .chat-list-item:hover { background: var(--bg-surface); }
        .chat-list-item.active { background: var(--bg-surface); border-left: 2px solid var(--accent); }
        .chat-list-item.pinned::before { content: ''; position: absolute; top: 6px; right: 8px; width: 6px; height: 6px; background: var(--warning); border-radius: 50%; }
        .chat-avatar { width: 36px; height: 36px; border-radius: 8px; background: var(--accent-dim); border: 1px solid rgba(0,212,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; color: var(--accent); flex-shrink: 0; position: relative; }
        .chat-avatar.group { background: rgba(124,58,237,0.12); border-color: rgba(124,58,237,0.2); color: #7c3aed; }
        .online-dot { position: absolute; bottom: -2px; right: -2px; width: 10px; height: 10px; border-radius: 50%; background: var(--success); border: 2px solid var(--bg-elevated); }
        .chat-info { flex: 1; min-width: 0; }
        .chat-name { font-size: 12px; font-weight: 600; color: var(--fg); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .chat-preview { font-size: 11px; color: var(--fg-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; margin-top: 1px; }
        .chat-meta { display: flex; flex-direction: column; align-items: flex-end; gap: 4px; flex-shrink: 0; }
        .chat-time { font-size: 9px; color: var(--fg-muted); }
        .unread-badge { background: var(--accent); color: var(--bg); border-radius: 10px; padding: 1px 6px; font-size: 9px; font-weight: 700; min-width: 18px; text-align: center; }
        .muted-icon { color: var(--fg-muted); }

        .empty-list { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px 20px; text-align: center; color: var(--fg-muted); font-size: 11px; gap: 10px; }
        .empty-list svg { opacity: 0.3; }

        /* USER FOOTER */
        .sidebar-footer { padding: 10px 12px; border-top: 1px solid var(--border); display: flex; align-items: center; gap: 10px; }
        .user-avatar { width: 32px; height: 32px; border-radius: 7px; background: var(--accent-dim); border: 1px solid rgba(0,212,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 700; color: var(--accent); flex-shrink: 0; }
        .user-info { flex: 1; min-width: 0; }
        .user-name { font-size: 12px; font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .user-mood { font-size: 10px; color: var(--fg-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

        /* MAIN CHAT */
        .main { flex: 1; display: flex; flex-direction: column; min-width: 0; background: var(--bg); }

        /* EMPTY STATE */
        .empty-chat { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--fg-muted); gap: 12px; }
        .empty-chat-icon { width: 60px; height: 60px; border-radius: 14px; background: var(--bg-elevated); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; }
        .empty-chat h2 { font-size: 15px; color: var(--fg-dim); font-weight: 500; }
        .empty-chat p { font-size: 11px; text-align: center; max-width: 260px; }

        /* CHAT HEADER */
        .chat-header { height: var(--chat-header-h); border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 16px; gap: 12px; background: var(--bg-elevated); flex-shrink: 0; }
        .chat-header-avatar { width: 36px; height: 36px; border-radius: 8px; background: var(--accent-dim); border: 1px solid rgba(0,212,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; color: var(--accent); flex-shrink: 0; }
        .chat-header-info { flex: 1; min-width: 0; }
        .chat-header-name { font-size: 13px; font-weight: 600; }
        .chat-header-status { font-size: 10px; color: var(--fg-muted); }
        .chat-header-actions { display: flex; gap: 6px; }

        /* MESSAGES */
        .messages-wrap { flex: 1; overflow-y: auto; padding: 16px; display: flex; flex-direction: column; gap: 1px; scroll-behavior: smooth; }

        .msg-day-divider { text-align: center; font-size: 10px; color: var(--fg-muted); padding: 12px; display: flex; align-items: center; gap: 10px; }
        .msg-day-divider::before, .msg-day-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }

        .msg { display: flex; flex-direction: column; margin-bottom: 2px; animation: msgIn 0.2s ease; }
        @keyframes msgIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: none; } }
        .msg.self { align-items: flex-end; }

        .msg-header { display: flex; align-items: center; gap: 7px; padding: 0 4px; margin-bottom: 3px; }
        .msg.self .msg-header { flex-direction: row-reverse; }
        .msg-sender { font-size: 11px; font-weight: 600; color: var(--accent); }
        .msg.self .msg-sender { color: var(--success); }
        .msg-time { font-size: 10px; color: var(--fg-muted); }
        .msg-edited { font-size: 9px; color: var(--fg-muted); font-style: italic; }

        .msg-bubble { background: var(--bg-elevated); border: 1px solid var(--border); border-radius: 10px; border-top-left-radius: 2px; padding: 9px 13px; font-size: 13px; color: var(--fg); max-width: min(68%, 520px); word-break: break-word; line-height: 1.5; position: relative; white-space: pre-wrap; }
        .msg.self .msg-bubble { background: var(--bg-surface); border-color: var(--border-bright); border-top-right-radius: 2px; border-top-left-radius: 10px; }
        .msg-bubble.deleted { color: var(--fg-muted); font-style: italic; font-size: 12px; }

        .msg-bubble img { max-width: 260px; max-height: 200px; border-radius: 6px; display: block; margin-top: 4px; cursor: pointer; object-fit: cover; }
        .msg-bubble img:hover { opacity: 0.85; }

        .msg-reply-preview { background: var(--bg-surface); border-left: 2px solid var(--accent); border-radius: 4px; padding: 4px 10px; margin-bottom: 6px; font-size: 11px; color: var(--fg-muted); cursor: pointer; }
        .msg-reply-preview .reply-sender { color: var(--accent); font-weight: 600; margin-bottom: 1px; font-size: 10px; }

        .msg-reactions { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 4px; padding: 0 2px; }
        .reaction-chip { background: var(--bg-surface); border: 1px solid var(--border); border-radius: 100px; padding: 2px 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; gap: 3px; transition: all 0.15s; }
        .reaction-chip:hover { border-color: var(--accent); }
        .reaction-chip.mine { border-color: var(--accent); background: var(--accent-dim); }
        .reaction-chip .reaction-count { font-size: 10px; color: var(--fg-muted); }

        .msg-actions { display: flex; gap: 3px; margin-top: 4px; padding: 0 2px; opacity: 0; transition: opacity 0.15s; }
        .msg:hover .msg-actions { opacity: 1; }
        .msg-action-btn { background: var(--bg-elevated); border: 1px solid var(--border); border-radius: 5px; padding: 3px 7px; font-size: 10px; color: var(--fg-muted); cursor: pointer; transition: all 0.15s; }
        .msg-action-btn:hover { border-color: var(--accent); color: var(--accent); }
        .msg-action-btn.danger:hover { border-color: var(--error); color: var(--error); }

        .system-msg { text-align: center; font-size: 10px; color: var(--fg-muted); padding: 4px 14px; background: var(--bg-elevated); border: 1px dashed var(--border); border-radius: 6px; margin: 6px auto; max-width: 380px; }
        .system-msg.success { color: var(--success); border-color: rgba(0,255,136,0.3); }
        .system-msg.error { color: var(--error); border-color: rgba(255,59,92,0.3); }

        .typing-indicator { display: flex; align-items: center; gap: 8px; padding: 8px 4px; font-size: 11px; color: var(--fg-muted); font-style: italic; }
        .typing-dots { display: flex; gap: 3px; }
        .typing-dot { width: 4px; height: 4px; border-radius: 50%; background: var(--fg-muted); animation: typingDot 1.2s ease infinite; }
        .typing-dot:nth-child(2){animation-delay:.2s} .typing-dot:nth-child(3){animation-delay:.4s}
        @keyframes typingDot { 0%,100%{opacity:.3;transform:translateY(0)} 50%{opacity:1;transform:translateY(-3px)} }

        /* READ RECEIPTS */
        .read-receipts { display: flex; gap: 2px; margin-top: 3px; padding: 0 3px; }
        .read-receipt { font-size: 9px; color: var(--success); }

        /* INPUT AREA */
        .input-area { padding: 12px 16px; border-top: 1px solid var(--border); background: var(--bg-elevated); flex-shrink: 0; }
        .reply-preview { background: var(--bg-surface); border: 1px solid var(--border); border-left: 3px solid var(--accent); border-radius: 6px; padding: 6px 12px; margin-bottom: 8px; display: flex; align-items: center; justify-content: space-between; display: none; }
        .reply-preview.visible { display: flex; }
        .reply-preview-text { font-size: 11px; color: var(--fg-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .reply-cancel { background: none; border: none; color: var(--fg-muted); cursor: pointer; padding: 2px; }
        .reply-cancel:hover { color: var(--error); }
        .input-row { display: flex; gap: 8px; align-items: flex-end; }
        .msg-input { flex: 1; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 10px; padding: 10px 14px; color: var(--fg); font-family: 'JetBrains Mono', monospace; font-size: 13px; outline: none; resize: none; max-height: 140px; min-height: 40px; transition: border-color 0.2s; line-height: 1.5; overflow-y: auto; }
        .msg-input:focus { border-color: var(--accent); }
        .msg-input::placeholder { color: var(--fg-muted); }
        .send-btn { width: 40px; height: 40px; background: var(--accent); border: none; border-radius: 10px; color: var(--bg); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; flex-shrink: 0; }
        .send-btn:hover { background: #00bbdf; box-shadow: 0 4px 12px var(--accent-glow); }
        .send-btn:disabled { opacity: 0.4; cursor: not-allowed; }

        /* EMOJI PICKER */
        .emoji-picker { position: absolute; bottom: 70px; right: 16px; background: var(--bg-elevated); border: 1px solid var(--border-bright); border-radius: 12px; padding: 12px; width: 300px; max-height: 280px; overflow-y: auto; z-index: 200; display: none; box-shadow: 0 16px 40px rgba(0,0,0,0.5); animation: popIn 0.15s ease; }
        .emoji-picker.visible { display: block; }
        @keyframes popIn { from { opacity: 0; transform: scale(0.95) translateY(8px); } to { opacity: 1; transform: none; } }
        .emoji-category { font-size: 9px; color: var(--fg-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 6px; margin-top: 10px; }
        .emoji-grid { display: flex; flex-wrap: wrap; gap: 2px; }
        .emoji-btn { width: 32px; height: 32px; border: none; background: none; cursor: pointer; font-size: 18px; border-radius: 6px; transition: background 0.1s; display: flex; align-items: center; justify-content: center; }
        .emoji-btn:hover { background: var(--bg-surface); }

        /* GIF PICKER */
        .gif-picker { position: absolute; bottom: 70px; right: 16px; background: var(--bg-elevated); border: 1px solid var(--border-bright); border-radius: 12px; padding: 12px; width: 320px; max-height: 340px; overflow-y: auto; z-index: 200; display: none; box-shadow: 0 16px 40px rgba(0,0,0,0.5); }
        .gif-picker.visible { display: block; }
        .gif-search { width: 100%; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 6px; padding: 8px 12px; color: var(--fg); font-family: 'JetBrains Mono', monospace; font-size: 12px; outline: none; margin-bottom: 10px; }
        .gif-search:focus { border-color: var(--accent); }
        .gif-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
        .gif-item { border-radius: 6px; overflow: hidden; cursor: pointer; aspect-ratio: 16/9; background: var(--bg-surface); }
        .gif-item img { width: 100%; height: 100%; object-fit: cover; transition: opacity 0.15s; }
        .gif-item:hover img { opacity: 0.8; }
        .gif-note { font-size: 10px; color: var(--fg-muted); text-align: center; margin-top: 8px; }

        /* MODALS */
        .modal-overlay { position: fixed; inset: 0; background: rgba(8,8,13,0.9); display: flex; align-items: center; justify-content: center; z-index: 500; padding: 20px; backdrop-filter: blur(8px); opacity: 0; pointer-events: none; transition: opacity 0.2s; }
        .modal-overlay.visible { opacity: 1; pointer-events: all; }
        .modal { background: var(--bg-elevated); border: 1px solid var(--border-bright); border-radius: 14px; padding: 32px; width: 100%; max-width: 440px; animation: cardIn 0.25s ease; position: relative; max-height: 90vh; overflow-y: auto; }
        @keyframes cardIn { from { opacity: 0; transform: translateY(20px) scale(0.97); } to { opacity: 1; transform: none; } }
        .modal-title { font-size: 16px; font-weight: 600; margin-bottom: 6px; }
        .modal-subtitle { font-size: 11px; color: var(--fg-muted); margin-bottom: 24px; }
        .modal-close { position: absolute; top: 14px; right: 14px; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 7px; padding: 6px; cursor: pointer; color: var(--fg-muted); display: flex; }
        .modal-close:hover { border-color: var(--error); color: var(--error); }

        .input-group { margin-bottom: 16px; }
        .input-label { display: block; font-size: 10px; text-transform: uppercase; letter-spacing: 0.12em; color: var(--fg-muted); margin-bottom: 7px; }
        .input-field { width: 100%; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 8px; padding: 11px 14px; color: var(--fg); font-family: 'JetBrains Mono', monospace; font-size: 13px; outline: none; transition: border-color 0.2s, box-shadow 0.2s; }
        .input-field:focus { border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-dim); }
        .input-field::placeholder { color: var(--fg-muted); }
        textarea.input-field { resize: vertical; min-height: 80px; line-height: 1.5; }

        .btn { padding: 10px 20px; border: 1px solid var(--border-bright); border-radius: 8px; background: var(--bg-surface); color: var(--fg); font-family: 'JetBrains Mono', monospace; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s; letter-spacing: 0.05em; }
        .btn:hover { border-color: var(--accent); background: var(--bg-elevated); }
        .btn-primary { background: var(--accent); color: var(--bg); border-color: var(--accent); font-weight: 600; }
        .btn-primary:hover { background: #00bbdf; border-color: #00bbdf; box-shadow: 0 4px 14px var(--accent-glow); }
        .btn-danger { border-color: var(--error); color: var(--error); }
        .btn-danger:hover { background: var(--error); color: var(--bg); }
        .btn-row { display: flex; gap: 10px; margin-top: 20px; }
        .btn-row .btn { flex: 1; }
        .modal-error { font-size: 11px; color: var(--error); margin-bottom: 14px; padding: 8px 12px; background: rgba(255,59,92,0.08); border: 1px solid rgba(255,59,92,0.2); border-radius: 6px; display: none; }
        .modal-error.visible { display: block; }
        .modal-success { font-size: 11px; color: var(--success); margin-bottom: 14px; padding: 8px 12px; background: rgba(0,255,136,0.06); border: 1px solid rgba(0,255,136,0.2); border-radius: 6px; display: none; }
        .modal-success.visible { display: block; }

        /* FRIEND REQUESTS */
        .request-item { display: flex; align-items: center; gap: 10px; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 8px; }
        .request-avatar { width: 34px; height: 34px; border-radius: 7px; background: var(--accent-dim); border: 1px solid rgba(0,212,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 600; color: var(--accent); flex-shrink: 0; }
        .request-info { flex: 1; }
        .request-name { font-size: 12px; font-weight: 600; }
        .request-sub { font-size: 10px; color: var(--fg-muted); }
        .request-actions { display: flex; gap: 6px; }
        .accept-btn { padding: 5px 12px; background: var(--success); border: none; border-radius: 6px; color: var(--bg); font-family: 'JetBrains Mono', monospace; font-size: 11px; font-weight: 600; cursor: pointer; }
        .decline-btn { padding: 5px 12px; background: none; border: 1px solid var(--border-bright); border-radius: 6px; color: var(--fg-muted); font-family: 'JetBrains Mono', monospace; font-size: 11px; cursor: pointer; }
        .decline-btn:hover { border-color: var(--error); color: var(--error); }

        /* PROFILE PANEL */
        .profile-panel { width: 260px; border-left: 1px solid var(--border); background: var(--bg-elevated); display: flex; flex-direction: column; flex-shrink: 0; overflow-y: auto; padding: 20px 16px; }
        .profile-panel.hidden { display: none; }
        .profile-top { text-align: center; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--border); }
        .profile-avatar-lg { width: 64px; height: 64px; border-radius: 14px; background: var(--accent-dim); border: 1px solid rgba(0,212,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 26px; font-weight: 700; color: var(--accent); margin: 0 auto 12px; }
        .profile-username { font-size: 15px; font-weight: 700; margin-bottom: 4px; }
        .profile-status { display: inline-flex; align-items: center; gap: 6px; font-size: 10px; color: var(--fg-muted); }
        .profile-status-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--fg-muted); }
        .profile-status-dot.online { background: var(--success); box-shadow: 0 0 6px var(--success); }
        .profile-bio { font-size: 11px; color: var(--fg-dim); line-height: 1.6; margin: 8px 0; }
        .profile-mood { font-size: 11px; color: var(--fg-muted); padding: 4px 10px; background: var(--bg-surface); border-radius: 100px; display: inline-block; margin-top: 6px; }
        .profile-section-title { font-size: 9px; text-transform: uppercase; letter-spacing: 0.12em; color: var(--fg-muted); margin-bottom: 10px; }
        .profile-action-btn { display: flex; align-items: center; gap: 8px; width: 100%; padding: 9px 12px; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 8px; color: var(--fg); font-family: 'JetBrains Mono', monospace; font-size: 11px; cursor: pointer; margin-bottom: 6px; transition: all 0.15s; text-align: left; }
        .profile-action-btn:hover { border-color: var(--accent); color: var(--accent); }
        .profile-action-btn.danger:hover { border-color: var(--error); color: var(--error); }
        .streak-display { padding: 10px 12px; background: var(--bg-surface); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 6px; }
        .streak-title { font-size: 10px; color: var(--fg-muted); margin-bottom: 2px; }
        .streak-count { font-size: 18px; font-weight: 700; color: var(--warning); }

        /* SETTINGS */
        .settings-section { margin-bottom: 28px; }
        .settings-section-title { font-size: 10px; text-transform: uppercase; letter-spacing: 0.12em; color: var(--fg-muted); margin-bottom: 12px; padding-bottom: 6px; border-bottom: 1px solid var(--border); }
        .setting-row { display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(30,30,46,0.5); }
        .setting-label { font-size: 12px; }
        .setting-sub { font-size: 10px; color: var(--fg-muted); margin-top: 1px; }
        .toggle { width: 36px; height: 20px; border-radius: 100px; background: var(--bg-surface); border: 1px solid var(--border-bright); cursor: pointer; transition: all 0.2s; position: relative; flex-shrink: 0; }
        .toggle.on { background: var(--accent); border-color: var(--accent); }
        .toggle::after { content: ''; position: absolute; width: 14px; height: 14px; border-radius: 50%; background: var(--fg-muted); top: 2px; left: 2px; transition: all 0.2s; }
        .toggle.on::after { background: var(--bg); left: 18px; }
        select.input-field { cursor: pointer; }

        /* GAMES */
        .game-container { background: var(--bg-surface); border: 1px solid var(--border); border-radius: 10px; padding: 16px; margin: 8px 0; max-width: min(400px, 90%); }
        .game-title { font-size: 12px; font-weight: 600; color: var(--accent); margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between; }
        .ttt-board { display: grid; grid-template-columns: repeat(3,1fr); gap: 6px; margin-bottom: 12px; }
        .ttt-cell { aspect-ratio: 1; background: var(--bg-elevated); border: 1px solid var(--border); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 22px; cursor: pointer; transition: all 0.15s; }
        .ttt-cell:hover { border-color: var(--accent); background: var(--accent-dim); }
        .ttt-cell.taken { cursor: default; }
        .cf-board { display: flex; flex-direction: column; gap: 4px; }
        .cf-row { display: flex; gap: 4px; }
        .cf-cell { width: 34px; height: 34px; border-radius: 50%; background: var(--bg-elevated); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.15s; }
        .cf-cell[data-player="1"] { background: #ff6b35; border-color: #ff6b35; }
        .cf-cell[data-player="2"] { background: #ffd700; border-color: #ffd700; }
        .game-status { font-size: 11px; color: var(--fg-muted); margin-bottom: 8px; }
        .game-btn { padding: 6px 16px; background: var(--accent); border: none; border-radius: 6px; color: var(--bg); font-family: 'JetBrains Mono', monospace; font-size: 11px; font-weight: 600; cursor: pointer; }
        .game-btn:hover { background: #00bbdf; }
        .hangman-word { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
        .hangman-letter { width: 24px; text-align: center; border-bottom: 2px solid var(--fg-muted); font-size: 16px; font-weight: 600; padding-bottom: 2px; }
        .hangman-guesses { font-size: 11px; color: var(--fg-muted); margin-bottom: 8px; }
        .hangman-input { display: flex; gap: 8px; }
        .checkers-board { display: grid; grid-template-columns: repeat(8,1fr); gap: 2px; }
        .checkers-cell { aspect-ratio: 1; border-radius: 2px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .checkers-cell.light { background: #2a2a3e; }
        .checkers-cell.dark { background: #14141e; }
        .checkers-piece { width: 80%; height: 80%; border-radius: 50%; border: 2px solid rgba(255,255,255,0.2); }
        .checkers-piece.p1 { background: radial-gradient(circle at 35% 35%, #ff8a65, #c62828); }
        .checkers-piece.p2 { background: radial-gradient(circle at 35% 35%, #eee, #999); }
        .checkers-piece.king::after { content: 'â™›'; position: absolute; font-size: 10px; color: rgba(255,255,255,0.8); }
        .poker-cards { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 10px; }
        .card { width: 44px; height: 62px; background: white; border-radius: 5px; border: 1px solid #ccc; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; cursor: pointer; transition: transform 0.15s; }
        .card:hover { transform: translateY(-4px); }
        .card.red { color: #c62828; }
        .card.black { color: #1a1a1a; }
        .card.face-down { background: #1e1e3a; color: var(--fg-muted); }
        .card.selected { transform: translateY(-6px); border-color: var(--accent); box-shadow: 0 0 8px var(--accent-glow); }

        /* IMAGE VIEWER */
        #imgViewer { position: fixed; inset: 0; background: rgba(8,8,13,0.97); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 800; backdrop-filter: blur(16px); display: none; }
        #imgViewer.visible { display: flex; }
        .img-viewer-close { position: absolute; top: 16px; right: 16px; background: var(--bg-elevated); border: 1px solid var(--border-bright); border-radius: 8px; padding: 8px; color: var(--fg); cursor: pointer; }
        .img-viewer-close:hover { border-color: var(--error); color: var(--error); }
        #imgViewerContent { max-width: 90vw; max-height: 90vh; }
        #imgViewerContent img { max-width: 100%; max-height: 90vh; border-radius: 6px; object-fit: contain; }

        /* SCREENSHOT ALERT */
        .screenshot-banner { position: fixed; top: 16px; left: 50%; transform: translateX(-50%); background: var(--error); color: var(--bg); padding: 10px 20px; border-radius: 8px; font-size: 12px; font-weight: 600; z-index: 9990; animation: bannerIn 0.3s ease; pointer-events: none; }
        @keyframes bannerIn { from { opacity: 0; transform: translateX(-50%) translateY(-20px); } to { opacity: 1; transform: translateX(-50%) translateY(0); } }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--border-bright); border-radius: 2px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--fg-muted); }

        .hidden { display: none !important; }

        @media (prefers-reduced-motion: reduce) { *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; } }
    </style>
</head>
<body>
<!-- LOADING -->
<div id="loadingScreen">
    <div class="loading-logo">BLACK<span class="accent">KEEP</span></div>
    <div class="loading-bars">
        <div class="loading-bar"></div><div class="loading-bar"></div><div class="loading-bar"></div><div class="loading-bar"></div><div class="loading-bar"></div>
    </div>
    <div class="loading-text" id="loadingText">Authenticating...</div>
</div>

<!-- IMAGE VIEWER -->
<div id="imgViewer">
    <button class="img-viewer-close" id="imgViewerClose">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
    <div id="imgViewerContent"></div>
</div>

<!-- ADD FRIEND MODAL -->
<div class="modal-overlay" id="addFriendModal">
    <div class="modal">
        <button class="modal-close" data-close="addFriendModal"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title">Add Friend</div>
        <div class="modal-subtitle">Send a friend request by username</div>
        <div class="modal-error" id="addFriendError"></div>
        <div class="modal-success" id="addFriendSuccess"></div>
        <div class="input-group">
            <label class="input-label">Username</label>
            <input type="text" class="input-field" id="addFriendInput" placeholder="ShadowAgent42" autocapitalize="none" spellcheck="false">
        </div>
        <div class="btn-row">
            <button class="btn btn-primary" id="sendFriendRequest">Send Request</button>
        </div>
    </div>
</div>

<!-- FRIEND REQUESTS MODAL -->
<div class="modal-overlay" id="friendRequestsModal">
    <div class="modal">
        <button class="modal-close" data-close="friendRequestsModal"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title">Friend Requests</div>
        <div class="modal-subtitle">Incoming requests</div>
        <div id="friendRequestsList"></div>
    </div>
</div>

<!-- NEW GROUP MODAL -->
<div class="modal-overlay" id="newGroupModal">
    <div class="modal">
        <button class="modal-close" data-close="newGroupModal"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title">Create Group</div>
        <div class="modal-subtitle">Add friends to a new group chat</div>
        <div class="modal-error" id="newGroupError"></div>
        <div class="input-group">
            <label class="input-label">Group Name</label>
            <input type="text" class="input-field" id="groupNameInput" placeholder="My Group" maxlength="40">
        </div>
        <div class="input-group">
            <label class="input-label">Add Friends</label>
            <div id="groupMemberList" style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;"></div>
        </div>
        <div class="btn-row">
            <button class="btn btn-primary" id="createGroupBtn">Create Group</button>
        </div>
    </div>
</div>

<!-- DISAPPEARING MESSAGES MODAL -->
<div class="modal-overlay" id="disappearModal">
    <div class="modal">
        <button class="modal-close" data-close="disappearModal"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title">Disappearing Messages</div>
        <div class="modal-subtitle">Messages will auto-delete after this time</div>
        <div class="input-group">
            <label class="input-label">Duration</label>
            <select class="input-field" id="disappearSelect">
                <option value="0">Off</option>
                <option value="30000">30 seconds</option>
                <option value="300000">5 minutes</option>
                <option value="3600000">1 hour</option>
                <option value="86400000">24 hours</option>
                <option value="604800000">7 days</option>
            </select>
        </div>
        <div class="btn-row">
            <button class="btn btn-primary" id="setDisappearBtn">Save</button>
        </div>
    </div>
</div>

<!-- EDIT MESSAGE MODAL -->
<div class="modal-overlay" id="editMsgModal">
    <div class="modal">
        <button class="modal-close" data-close="editMsgModal"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title">Edit Message</div>
        <div class="input-group">
            <textarea class="input-field" id="editMsgInput" rows="3"></textarea>
        </div>
        <div class="btn-row">
            <button class="btn btn-primary" id="saveEditBtn">Save</button>
        </div>
    </div>
</div>

<!-- IMAGE EMBED MODAL -->
<div class="modal-overlay" id="imageEmbedModal">
    <div class="modal">
        <button class="modal-close" data-close="imageEmbedModal"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title">Embed Image</div>
        <div class="modal-subtitle">Paste a direct image link</div>
        <div class="modal-error" id="imageEmbedError"></div>
        <div class="input-group">
            <label class="input-label">Image URL</label>
            <input type="url" class="input-field" id="imageEmbedUrl" placeholder="https://example.com/image.png">
        </div>
        <div class="btn-row">
            <button class="btn btn-primary" id="sendImageEmbed">Send Image</button>
        </div>
    </div>
</div>

<!-- SETTINGS MODAL -->
<div class="modal-overlay" id="settingsModal">
    <div class="modal" style="max-width:520px;">
        <button class="modal-close" data-close="settingsModal"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title">Settings</div>
        <div style="display:flex;gap:16px;margin-top:20px;">
            <div style="display:flex;flex-direction:column;gap:2px;min-width:120px;">
                <button class="settings-tab-btn active" data-tab="account">Account</button>
                <button class="settings-tab-btn" data-tab="privacy">Privacy</button>
                <button class="settings-tab-btn" data-tab="security">Security</button>
                <button class="settings-tab-btn" data-tab="chats">Chats</button>
                <button class="settings-tab-btn" data-tab="appearance">Appearance</button>
                <button class="settings-tab-btn" data-tab="data">Data</button>
                <button class="settings-tab-btn danger" data-tab="danger">Danger</button>
            </div>
            <div id="settingsContent" style="flex:1;min-width:0;"></div>
        </div>
    </div>
</div>

<style>
.settings-tab-btn { padding: 8px 12px; background: none; border: 1px solid transparent; border-radius: 7px; color: var(--fg-muted); font-family: 'JetBrains Mono', monospace; font-size: 11px; cursor: pointer; text-align: left; transition: all 0.15s; }
.settings-tab-btn:hover { color: var(--fg); border-color: var(--border); }
.settings-tab-btn.active { color: var(--accent); border-color: rgba(0,212,255,0.2); background: var(--accent-dim); }
.settings-tab-btn.danger { color: var(--error); }
.settings-tab-btn.danger:hover { background: rgba(255,59,92,0.08); border-color: rgba(255,59,92,0.2); }
.settings-tab-btn.danger.active { color: var(--error); border-color: rgba(255,59,92,0.3); background: rgba(255,59,92,0.08); }
</style>

<!-- APP -->
<div class="app" id="app" style="display:none;">
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">BLACK<span class="accent">KEEP</span></div>
            <div class="sidebar-actions">
                <button class="icon-btn" id="addFriendBtn" title="Add Friend">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg>
                </button>
                <button class="icon-btn" id="friendReqBtn" title="Friend Requests">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    <div class="tab-badge" id="friendReqBadge"></div>
                </button>
                <button class="icon-btn" id="newGroupBtn" title="New Group">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                </button>
                <button class="icon-btn" id="settingsBtn" title="Settings">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                </button>
            </div>
        </div>

        <div class="sidebar-tabs">
            <button class="tab-btn active" data-tab="chats">Chats</button>
            <button class="tab-btn" data-tab="friends">Friends<div class="tab-badge" id="chatsBadge"></div></button>
        </div>

        <div class="sidebar-search">
            <input type="text" class="search-input" id="searchInput" placeholder="Search...">
        </div>

        <div class="chat-list" id="chatList"></div>

        <div class="sidebar-footer">
            <div class="user-avatar" id="myAvatar"></div>
            <div class="user-info">
                <div class="user-name" id="myUsername"></div>
                <div class="user-mood" id="myMood">No mood set</div>
            </div>
        </div>
    </aside>

    <!-- MAIN AREA -->
    <main class="main" id="mainArea">
        <!-- EMPTY STATE -->
        <div class="empty-chat" id="emptyChat">
            <div class="empty-chat-icon">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#5a5a72" stroke-width="1.5"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            </div>
            <h2>Select a chat</h2>
            <p>Choose a conversation from the sidebar or add a friend to get started.</p>
        </div>

        <!-- CHAT VIEW -->
        <div id="chatView" style="display:none;flex-direction:column;height:100%;">
            <div class="chat-header">
                <div class="chat-header-avatar" id="chatAvatar"></div>
                <div class="chat-header-info">
                    <div class="chat-header-name" id="chatName"></div>
                    <div class="chat-header-status" id="chatStatus"></div>
                </div>
                <div class="chat-header-actions">
                    <button class="icon-btn" id="chatImageBtn" title="Embed Image">
                        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                    </button>
                    <button class="icon-btn" id="chatGifBtn" title="GIF">
                        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2"/><polyline points="17 2 12 7 7 2"/></svg>
                    </button>
                    <button class="icon-btn" id="chatDisappearBtn" title="Disappearing Messages">
                        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                    </button>
                    <button class="icon-btn" id="chatMuteBtn" title="Mute">
                        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="1" y1="1" x2="23" y2="23"/><path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"/><path d="M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>
                    </button>
                    <button class="icon-btn" id="chatPinBtn" title="Pin Chat">
                        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                    </button>
                    <button class="icon-btn" id="viewProfileBtn" title="View Profile">
                        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7"/></svg>
                    </button>
                </div>
            </div>

            <div class="messages-wrap" id="messagesWrap">
                <div class="typing-indicator hidden" id="typingIndicator">
                    <div class="typing-dots"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>
                    <span id="typingName">typing...</span>
                </div>
            </div>

            <div class="emoji-picker" id="emojiPicker"></div>
            <div class="gif-picker" id="gifPicker">
                <input type="text" class="gif-search" id="gifSearch" placeholder="Search GIFs (Tenor)...">
                <div class="gif-grid" id="gifGrid"></div>
                <div class="gif-note">GIFs via link embed</div>
            </div>

            <div class="input-area" style="position:relative;">
                <div class="reply-preview" id="replyPreview">
                    <span class="reply-preview-text" id="replyPreviewText"></span>
                    <button class="reply-cancel" id="replyCancel">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    </button>
                </div>
                <div class="input-row">
                    <button class="icon-btn" id="emojiBtn" title="Emoji">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>
                    </button>
                    <textarea class="msg-input" id="msgInput" placeholder="Type a message... (@mention in groups)" rows="1"></textarea>
                    <button class="send-btn" id="sendBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- PROFILE PANEL -->
    <aside class="profile-panel hidden" id="profilePanel">
        <div class="profile-top">
            <div class="profile-avatar-lg" id="profileAvatarLg"></div>
            <div class="profile-username" id="profileUsername"></div>
            <div class="profile-status" id="profileStatus">
                <div class="profile-status-dot" id="profileStatusDot"></div>
                <span id="profileStatusText"></span>
            </div>
            <div class="profile-bio" id="profileBio"></div>
            <div class="profile-mood" id="profileMood" style="display:none;"></div>
        </div>
        <div class="streak-display" id="profileStreak" style="display:none;">
            <div class="streak-title">ðŸ”¥ Chat Streak</div>
            <div class="streak-count" id="profileStreakCount">0</div>
        </div>
        <div class="profile-section-title">Actions</div>
        <button class="profile-action-btn" id="blockUserBtn">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/></svg>
            Block User
        </button>
        <button class="profile-action-btn" id="removeFriendBtn">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="23" y1="11" x2="17" y2="11"/></svg>
            Remove Friend
        </button>
    </aside>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="db.js"></script>
<script src="auth.js"></script>
<script src="app.js"></script>
</body>
</html>
